<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
      PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mapper.reservation">

<select id="selectRoomInfos" resultType="map" parameterType="map">
	select a.room_id, a.room_nm, a.use_fee, a.additional_fee, a.standard_person, a.max_person,
	       b.status_cd
	  from room_info a left outer join ( select a.room_id, 'Y' status_cd
										   from reservation a
										  where STR_TO_DATE(#{reserveDt}, '%Y%m%d') between a.start_dt and a.end_dt
										    and a.reserv_code != 'D'
										 group by a.room_id ) b on a.room_id = b.room_id
</select>
</mapper>